<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description"
    content="X Project is a student activity established in 2012 at Cairo University, offering leadership, teamwork, and academic development.">
  <meta name="author" content="X Project">

  <meta property="og:title" content="X Project | Official Website">
  <meta property="og:description"
    content="Join X Project, the leading student activity at Cairo University since 2012.">
  <meta property="og:image" content="https://x-project.co/X-Project/img/logo.png">
  <meta property="og:url" content="https://x-project.co/X-Project/home.html">
  <meta property="og:type" content="website">

  <meta name="keywords"
    content="X Project, X project, x project, xproject, Xproject, XProject,Student Activity, Cairo University, Entrepreneurship, Leadership, University Events">

  <link rel="icon" href="../img/logo.png" type="image/png">

  <title>Register | X Project</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="page">
    <div class="login">
      <div class="logo">
        <img src="logo & Slogan.png" alt="X Project Logo" width="150px" />
      </div>

      <!-- start form -->
      <form class="login-form" id="registerForm">
        <h2>Create New Account</h2>

        <div class="form-group">
          <label for="name">Full Name</label>
          <input type="text" id="name" name="name" placeholder="Enter your full name" required />
        </div>

        <div class="form-group">
          <label for="email">Email Address</label>
          <input type="email" id="email" name="email" placeholder="Enter your email" required />
        </div>

        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" id="password" name="password" placeholder="Create a password" required />
        </div>

        <div class="form-group">
          <label for="committee">Committee</label>
          <select id="committee" name="committee" required>
            <option value="">-- Select Committee --</option>
            <option value="HR & QM">HR & QM</option>
            <option value="PM">PM</option>
            <option value="SR">SR</option>
            <option value="FR">FR</option>
            <option value="PR">PR</option>
            <option value="Logistics">Logistics</option>
            <option value="Marketing">Marketing</option>
            <option value="Photography">Photography</option>
            <option value="Graphic Design">Graphic Design</option>
            <option value="Web Development">Web Development</option>
            <option value="JR">JR</option>
            <option value="Team 1">Team 1</option>
            <option value="Team 2">Team 2</option>
            <option value="Team 3">Team 3</option>
            <option value="Team 4">Team 4</option>
            <option value="Team 5">Team 5</option>
            <option value="Team 6">Team 6</option>
            <option value="Team 7">Team 7</option>
            <option value="Team 8">Team 8</option>
            <option value="Team 9">Team 9</option>
            <option value="Team 10">Team 10</option>
          </select>
        </div>

        <button type="submit" class="submit-btn">Register</button>
        <div class="links">
          <a href="login.html">Already have an account? Login</a>
        </div>
      </form>
    </div>

    <!-- footer -->
    <footer class="main-footer">
      <div class="footer-content">
        <p>&copy;2025 X Project. All rights reserved.</p>
        <div class="footer-links">
          <a href="#">Privacy Policy</a>
          <a href="#">Terms of Service</a>
          <a href="#">Contact Us</a>
        </div>
      </div>
    </footer>
  </div>

  <script>
    document.getElementById("registerForm").addEventListener("submit", async function (e) {
      e.preventDefault();

      const name = document.getElementById("name").value;
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      const committee = document.getElementById("committee").value;

      try {
        const response = await fetch("https://x-project.co/api/register", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name, email, password, committee }),
        });

        const result = await response.json();

        if (response.ok) {
          // Auto login after registration
          const loginRes = await fetch("https://x-project.co/api/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email, password })
          });

          const loginResult = await loginRes.json();

          if (loginRes.ok) {
            localStorage.setItem("token", loginResult.token);
            localStorage.setItem("memberName", loginResult.user.name);
            localStorage.setItem("memberCommittee", loginResult.user.committee);
            window.location.href = "Home.html";
          } else {
            alert("Account created but auto-login failed. Please login manually.");
            window.location.href = "login.html";
          }
        }
      } catch (err) {
        alert("Network error. Please try again.");
      }
    });
  </script>
</body>

</html>