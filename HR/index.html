<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description"
        content="X Project is a student activity established in 2012 at Cairo University, offering leadership, teamwork, and academic development.">
    <meta name="author" content="X Project">

    <meta property="og:title" content="X Project | Official Website">
    <meta property="og:description"
        content="Join X Project, the leading student activity at Cairo University since 2012.">
    <meta property="og:image" content="https://x-project.co/X-Project/img/logo.png">
    <meta property="og:url" content="https://x-project.co/X-Project/home.html">
    <meta property="og:type" content="website">

    <meta name="keywords"
        content="X Project, X project, x project, xproject, Xproject, XProject,Student Activity, Cairo University, Entrepreneurship, Leadership, University Events">

    <link rel="icon" href="../img/logo.png" type="image/png">

    <title>2025 Attendance Schedule</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="Heading">
        <!-- Header Image -->
        <div class="header-image">
            <img src="logo & Slogan.png" alt="Calendar and Schedule" width="200px">
        </div>

        <h1>2025 Attendance Schedule</h1>
        <div class="select-wrapper">
            <label for="committeeSelect">Select Committee or Team:</label>
            <select id="committeeSelect" onchange="fetchCommitteeAttendance()">
                <option value="">-- Choose --</option>
                <option value="HR & QM">HR & QM</option>
                <option value="PM">PM</option>
                <option value="SR">SR</option>
                <option value="FR">FR</option>
                <option value="PR">PR</option>
                <option value="Logistics">Logistics</option>
                <option value="Marketing">Marketing</option>
                <option value="Photography">Photography</option>
                <option value="Graphic Design">Graphic Design</option>
                <option value="Web Development">Web Development</option>
                <option value="JR">JR</option>
                <option value="Team 1">Team 1</option>
                <option value="Team 2">Team 2</option>
                <option value="Team 3">Team 3</option>
                <option value="Team 4">Team 4</option>
                <option value="Team 5">Team 5</option>
                <option value="Team 6">Team 6</option>
                <option value="Team 7">Team 7</option>
                <option value="Team 8">Team 8</option>
                <option value="Team 9">Team 9</option>
                <option value="Team 10">Team 10</option>
            </select>
        </div>
        <div class="table-parent ">
            <div class="table-child ">
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Name</th>
                            <th>Day</th>
                            <th>Date</th>
                            <th>Time</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>

                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        async function fetchCommitteeAttendance() {
            const committee = document.getElementById('committeeSelect').value;
            const tbody = document.querySelector("tbody");

            if (!committee) {
                tbody.innerHTML = `<tr><td colspan="6">Please select a committee or team.</td></tr>`;
                return;
            }

            try {
                const response = await fetch(`https://x-project.co/api/sessions/committee-attendance?committee=${encodeURIComponent(committee)}`);
                const data = await response.json();

                tbody.innerHTML = '';

                if (Array.isArray(data) && data.length > 0) {
                    data.forEach((entry, index) => {
                        const date = new Date(entry.date);
                        const day = date.toLocaleDateString('en-US', { weekday: 'long' });

                        let statusText = entry.status;
                        if (entry.status === 'Late' && entry.late_by_minutes != null) {
                            statusText += ` (${entry.late_by_minutes} mins late)`;
                        }

                        const row = `
                            <tr>
                                <td>${index + 1}</td>
                                <td>${entry.name}</td>
                                <td>${day}</td>
                                <td>${entry.date}</td>
                                <td>${entry.time}</td>
                                <td class="${entry.status.toLowerCase()}">${statusText}</td>
                            </tr>
                        `;
                        tbody.innerHTML += row;
                    });
                } else {
                    tbody.innerHTML = `<tr><td colspan="6">No attendance records found for ${committee}.</td></tr>`;
                }

            } catch (error) {
                console.error("Error fetching committee attendance:", error);
                tbody.innerHTML = `<tr><td colspan="6">Error loading data.</td></tr>`;
            }
        }
    </script>

</body>

</html>